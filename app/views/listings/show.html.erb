<h1><%= @listing.title%></h1>

<button id="stripePayment"> Buy Album $<%= number_with_precision(@listing.price / 100.0, precision: 2 ) %></button>


<script>                                                                            //This is the "dirty way" -Garret 2019 
document.getElementById("stripePayment").addEventListener("click", function() {
var stripe = Stripe('<%= Rails.application.credentials.dig(:stripe, :public) %>');
    stripe.redirectToCheckout({
      sessionId: '<%= @stripe_session_id %>',
    }).then(function (result) {
      // If `redirectToCheckout` fails due to a browser or network
      // error, display the localized error message to your customer
      // using `result.error.message`.
    });
});
</script>

<%= javascript_include_tag "payment_button"%>